<script>
  // JS: English-only strings/comments
  const WEBHOOK_URL = "https://hooks.xn--h32b21du9cf7grcy2k20f.com/webhook/ask";

  const $ = (s)=>document.querySelector(s);
  const q = $('#q');
  const btn = $('#send');
  const sendLabel = $('#sendLabel');
  const statusBox = document.getElementById('res');

  function loading(on){
    if(on){ btn.disabled = true; sendLabel.innerHTML = '<span class="spin"></span>'; }
    else { btn.disabled = false; sendLabel.textContent = 'Send'; }
  }

  async function callWebhook(keyword){
    const res = await fetch(WEBHOOK_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ keyword })   // <-- send { keyword }
    });
    const html = await res.text();         // <-- expect HTML, not JSON
    if(!res.ok) throw new Error('HTTP ' + res.status);
    return html;
  }

  async function onSend(){
    const kw = (q.value || '').trim();
    if(!kw){ q.focus(); return; }
    statusBox.textContent = 'Generating... please wait.';
    loading(true);
    try{
      const html = await callWebhook(kw);
      document.open('text/html','replace'); // replace current page with returned HTML
      document.write(html);
      document.close();
    }catch(e){
      statusBox.textContent = 'Error: ' + (e.message || 'unknown');
      loading(false);
    }
  }

  btn.addEventListener('click', onSend);
  q.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ e.preventDefault(); onSend(); }});
  (function(){
    const box = document.getElementById('helpers');
    box.addEventListener('click', (e)=>{
      const el = e.target.closest('.helper'); if(!el) return;
      q.value = el.getAttribute('data-text') || '';
      q.focus();
    });
  })();
</script>
